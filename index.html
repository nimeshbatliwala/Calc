<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Jaguar V12 - Precision Delete</title>
    <style>
        :root { --bg: #000; --panel: #111; --screen: #00ff41; --scr-txt: #000; --btn: #1a1a1a; --btn-txt: #fff; --rad: 20px; --accent: #00ff41; }

        /* V12 PAINT SHOP - 50 THEMES */
        body.t-0 { --bg:#000; --panel:#0a0a0a; --screen:#00ff41; --scr-txt:#000; --btn:#111; --btn-txt:#00ff41; --rad:0px; --accent:#00ff41; }
        body.t-1 { --bg:#1a0000; --panel:#300; --screen:#ff4500; --scr-txt:#fff; --btn:#400; --btn-txt:#ffeb3b; --rad:40px 0; --accent:#ffeb3b; }
        body.t-2 { --bg:#001a33; --panel:#002b52; --screen:#00d4ff; --scr-txt:#000; --btn:#003a6e; --btn-txt:#fff; --rad:30px; --accent:#00d4ff; }
        body.t-3 { --bg:#064e3b; --panel:#065f46; --screen:#34d399; --scr-txt:#064e3b; --btn:#064e3b; --btn-txt:#fff; --rad:15px; --accent:#34d399; }
        body.t-4 { --bg:#000; --panel:#111; --screen:#fff; --scr-txt:#000; --btn:#222; --btn-txt:#fff; --rad:25px; --accent:#fff; }
        body.t-5 { --bg:#1a1a1a; --panel:#000; --screen:#ffd700; --scr-txt:#000; --btn:#333; --btn-txt:#ffd700; --rad:50%; --accent:#ffd700; }
        body.t-6 { --bg:#2d0036; --panel:#4a0058; --screen:#f0f; --scr-txt:#fff; --btn:#6a007d; --btn-txt:#0ff; --rad:12px; --accent:#0ff; }
        body.t-7 { --bg:#3d1a00; --panel:#5c2a00; --screen:#ff8c00; --scr-txt:#000; --btn:#7a3a00; --btn-txt:#fff; --rad:20px; --accent:#ff8c00; }
        body.t-8 { --bg:#000; --panel:#1a1a1a; --screen:#ff003c; --scr-txt:#fff; --btn:#222; --btn-txt:#ff003c; --rad:0; --accent:#ff003c; }
        body.t-9 { --bg:#0e1111; --panel:#232b2b; --screen:#8faebf; --scr-txt:#000; --btn:#3b444b; --btn-txt:#8faebf; --rad:18px; --accent:#8faebf; }
        body.t-10 { --bg:#1b1b1b; --panel:#2d2d2d; --screen:#e0e0e0; --scr-txt:#111; --btn:#404040; --btn-txt:#fff; --rad:22px; --accent:#e0e0e0; }
        body.t-11 { --bg:#002200; --panel:#004400; --screen:#00ff00; --scr-txt:#000; --btn:#005500; --btn-txt:#fff; --rad:5px; --accent:#00ff00; }
        body.t-12 { --bg:#220022; --panel:#440044; --screen:#ff00ff; --scr-txt:#fff; --btn:#550055; --btn-txt:#00ffff; --rad:15px; --accent:#ff00ff; }
        body.t-13 { --bg:#000022; --panel:#000044; --screen:#4444ff; --scr-txt:#fff; --btn:#000066; --btn-txt:#ffaa00; --rad:30px; --accent:#4444ff; }
        body.t-14 { --bg:#1a0f00; --panel:#3d2b1f; --screen:#d2b48c; --scr-txt:#3d2b1f; --btn:#5d4037; --btn-txt:#fff; --rad:10px; --accent:#d2b48c; }
        body.t-15 { --bg:#001219; --panel:#005f73; --screen:#94d2bd; --scr-txt:#001219; --btn:#0a9396; --btn-txt:#fff; --rad:25px; --accent:#94d2bd; }
        body.t-16 { --bg:#2b2d42; --panel:#8d99ae; --screen:#edf2f4; --scr-txt:#2b2d42; --btn:#ef233c; --btn-txt:#fff; --rad:15px; --accent:#ef233c; }
        body.t-17 { --bg:#231942; --panel:#5e548e; --screen:#be95c4; --scr-txt:#231942; --btn:#9f86c0; --btn-txt:#fff; --rad:20px; --accent:#be95c4; }
        body.t-18 { --bg:#252422; --panel:#403d39; --screen:#eb5e28; --scr-txt:#fff; --btn:#252422; --btn-txt:#ccc; --rad:0; --accent:#eb5e28; }
        body.t-19 { --bg:#000; --panel:#111; --screen:#39ff14; --scr-txt:#000; --btn:#1a1a1a; --btn-txt:#39ff14; --rad:4px; --accent:#39ff14; }
        body.t-20 { --bg:#0d1b2a; --panel:#1b263b; --screen:#e0e1dd; --scr-txt:#0d1b2a; --btn:#415a77; --btn-txt:#fff; --rad:12px; --accent:#778da9; }
        body.t-21 { --bg:#2d6a4f; --panel:#40916c; --screen:#b7e4c7; --scr-txt:#1b4332; --btn:#52b788; --btn-txt:#fff; --rad:30px; --accent:#b7e4c7; }
        body.t-22 { --bg:#4a4e69; --panel:#9a8c98; --screen:#f2e9e4; --scr-txt:#22223b; --btn:#c9ada7; --btn-txt:#22223b; --rad:20px; --accent:#f2e9e4; }
        body.t-23 { --bg:#003566; --panel:#001d3d; --screen:#ffc300; --scr-txt:#000; --btn:#003566; --btn-txt:#ffd60a; --rad:10px; --accent:#ffc300; }
        body.t-24 { --bg:#5e0b15; --panel:#90323d; --screen:#d78a76; --scr-txt:#5e0b15; --btn:#a06464; --btn-txt:#fff; --rad:25px; --accent:#d78a76; }
        body.t-25 { --bg:#14213d; --panel:#000; --screen:#fca311; --scr-txt:#000; --btn:#14213d; --btn-txt:#fff; --rad:0; --accent:#fca311; }
        body.t-26 { --bg:#222; --panel:#444; --screen:#00b4d8; --scr-txt:#fff; --btn:#0077b6; --btn-txt:#fff; --rad:15px; --accent:#90e0ef; }
        body.t-27 { --bg:#38040e; --panel:#640d14; --screen:#ad2831; --scr-txt:#fff; --btn:#800e13; --btn-txt:#fff; --rad:50px 0; --accent:#ad2831; }
        body.t-28 { --bg:#1d3557; --panel:#457b9d; --screen:#a8dadc; --scr-txt:#1d3557; --btn:#e63946; --btn-txt:#fff; --rad:15px; --accent:#a8dadc; }
        body.t-29 { --bg:#000; --panel:#222; --screen:#ccff00; --scr-txt:#000; --btn:#111; --btn-txt:#ccff00; --rad:0; --accent:#ccff00; }
        body.t-30 { --bg:#2a0800; --panel:#4a1c00; --screen:#ffcc33; --scr-txt:#000; --btn:#6a2c00; --btn-txt:#fff; --rad:20px; --accent:#ffcc33; }
        body.t-31 { --bg:#001d3d; --panel:#003566; --screen:#ffc300; --scr-txt:#000; --btn:#001d3d; --btn-txt:#ffd60a; --rad:15px; --accent:#ffc300; }
        body.t-32 { --bg:#222; --panel:#111; --screen:#f4a261; --scr-txt:#000; --btn:#264653; --btn-txt:#fff; --rad:10px; --accent:#e76f51; }
        body.t-33 { --bg:#2d3142; --panel:#4f5d75; --screen:#bfc0c0; --scr-txt:#2d3142; --btn:#ef8354; --btn-txt:#fff; --rad:30px; --accent:#ef8354; }
        body.t-34 { --bg:#03071e; --panel:#370617; --screen:#faa307; --scr-txt:#000; --btn:#6a040f; --btn-txt:#fff; --rad:5px; --accent:#ffb703; }
        body.t-35 { --bg:#1b4332; --panel:#2d6a4f; --screen:#95d5b2; --scr-txt:#081c15; --btn:#40916c; --btn-txt:#fff; --rad:20px; --accent:#d8f3dc; }
        body.t-36 { --bg:#3a0ca3; --panel:#4361ee; --screen:#4cc9f0; --scr-txt:#fff; --btn:#7209b7; --btn-txt:#fff; --rad:15px; --accent:#f72585; }
        body.t-37 { --bg:#111; --panel:#222; --screen:#80ffdb; --scr-txt:#000; --btn:#333; --btn-txt:#56cfe1; --rad:12px; --accent:#72efdd; }
        body.t-38 { --bg:#000; --panel:#1a1a1a; --screen:#ff006e; --scr-txt:#fff; --btn:#333; --btn-txt:#3a86ff; --rad:25px; --accent:#ffbe0b; }
        body.t-39 { --bg:#1a1a1a; --panel:#333; --screen:#e9ecef; --scr-txt:#212529; --btn:#343a40; --btn-txt:#f8f9fa; --rad:8px; --accent:#adb5bd; }
        body.t-40 { --bg:#2a2a2a; --panel:#444; --screen:#fff3b0; --scr-txt:#335c67; --btn:#e09f3e; --btn-txt:#fff; --rad:20px; --accent:#9e2a2b; }
        body.t-41 { --bg:#10002b; --panel:#240046; --screen:#e0aaff; --scr-txt:#10002b; --btn:#3c096c; --btn-txt:#fff; --rad:35px 0; --accent:#c77dff; }
        body.t-42 { --bg:#000; --panel:#111; --screen:#ff5400; --scr-txt:#000; --btn:#333; --btn-txt:#ff0054; --rad:0; --accent:#9e0059; }
        body.t-43 { --bg:#1d3557; --panel:#457b9d; --screen:#f1faee; --scr-txt:#1d3557; --btn:#e63946; --btn-txt:#fff; --rad:15px; --accent:#a8dadc; }
        body.t-44 { --bg:#222; --panel:#000; --screen:#9ef01a; --scr-txt:#000; --btn:#38b000; --btn-txt:#fff; --rad:50%; --accent:#ccff33; }
        body.t-45 { --bg:#2b2d42; --panel:#8d99ae; --screen:#edf2f4; --scr-txt:#2b2d42; --btn:#d90429; --btn-txt:#fff; --rad:20px; --accent:#ef233c; }
        body.t-46 { --bg:#000; --panel:#1a1a1a; --screen:#caf0f8; --scr-txt:#03045e; --btn:#0077b6; --btn-txt:#fff; --rad:12px; --accent:#00b4d8; }
        body.t-47 { --bg:#220901; --panel:#621708; --screen:#f6bd60; --scr-txt:#220901; --btn:#941b0c; --btn-txt:#fff; --rad:18px; --accent:#bc3908; }
        body.t-48 { --bg:#011627; --panel:#fdfffc; --screen:#2ec4b6; --scr-txt:#011627; --btn:#e71d36; --btn-txt:#fff; --rad:10px; --accent:#ff9f1c; }
        body.t-49 { --bg:#000; --panel:#111; --screen:#ff99c8; --scr-txt:#000; --btn:#222; --btn-txt:#fcf6bd; --rad:30px; --accent:#d0f4de; }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        html, body { width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Arial Black', sans-serif; position: fixed; }

        #startup { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #start-btn { padding: 30px 60px; border: 4px solid var(--accent, #00ff41); color: var(--accent, #00ff41); background: transparent; font-size: 1.8rem; font-weight: 900; border-radius: 60px; cursor: pointer; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        #container { width: 100%; height: 100dvh; display: flex; flex-direction: column; background: var(--panel); opacity: 0; transition: 0.8s; }
        #garage-trigger { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); padding: 5px 25px; background: rgba(0,0,0,0.7); border: 1px solid var(--accent); border-radius: 20px; color: var(--accent); font-size: 13px; z-index: 200; cursor: pointer; font-weight: 900; letter-spacing: 2px; }

        #screen-area { padding-top: 50px; height: 32%; background: var(--screen); padding: 20px; display: flex; flex-direction: column; justify-content: flex-end; text-align: right; box-shadow: inset 0 0 50px rgba(0,0,0,0.5); }
        #eq-display { color: var(--scr-txt); font-size: 1.4rem; opacity: 0.7; margin-bottom: 5px; font-family: monospace; overflow-x: auto; white-space: nowrap; scrollbar-width: none; text-align: right; width: 100%; }
        #ans-display { color: var(--scr-txt); font-size: 3.5rem; font-weight: 900; line-height: 1; letter-spacing: -2px; }

        #pad { flex: 1; display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; padding: 6px; background: #000; padding-bottom: env(safe-area-inset-bottom); }
        .btn { background: var(--btn); border: 2px solid var(--accent); border-radius: var(--rad); color: var(--btn-txt); font-size: 1.8rem; font-weight: 900; display: flex; align-items: center; justify-content: center; box-shadow: 4px 4px 0px var(--accent); }
        .btn:active { transform: translate(3px, 3px); box-shadow: 0 0 0; }
        .eq { background: var(--accent) !important; color: var(--bg) !important; }

        /* Light Garage Modal */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(10px); z-index: 5000; display: none; align-items: center; justify-content: center; }
        .modal { width: 92%; max-height: 85vh; background: #fefefe; border-radius: 30px; padding: 20px; display: flex; flex-direction: column; color: #111; box-shadow: 0 25px 50px rgba(0,0,0,0.5); }
        .row { background: #f1f3f5; padding: 12px; border-radius: 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; font-weight: 900; font-size: 13px; }
        select, .tog, input[type="range"] { background: #fff; color: #000; border: 1px solid #ddd; padding: 8px; border-radius: 8px; font-weight: 900; width: 130px; }
        #hist { flex: 1; overflow-y: auto; background: #fff; border-radius: 12px; padding: 12px; margin-top: 10px; font-family: monospace; font-size: 13px; border: 1px solid #eee; }
        .clr-btn { background: #ff4d4d; color: #fff; border: none; padding: 6px 15px; border-radius: 8px; font-size: 11px; font-weight: 900; }
        .exit-btn { width: 100%; padding: 16px; background: #000; color: #fff; border-radius: 15px; margin-top: 15px; font-weight: 900; border: none; }
    </style>
</head>
<body class="t-0">

<div id="startup"><button id="start-btn" onclick="ignite()">START ENGINE</button></div>

<div id="container">
    <div id="garage-trigger" onclick="openGarage()">GARAGE</div>
    <div id="screen-area" onclick="nextTheme()">
        <div id="eq-display">0</div>
        <div id="ans-display">0</div>
    </div>
    <div id="pad">
        <button class="btn" data-v="AC">AC</button><button class="btn" data-v="DEL">⌫</button><button class="btn" data-v="%">%</button><button class="btn" data-v="/">÷</button>
        <button class="btn digit" data-en="7" data-gu="૭" data-v="7">7</button><button class="btn digit" data-en="8" data-gu="૮" data-v="8">8</button><button class="btn digit" data-en="9" data-gu="૯" data-v="9">9</button><button class="btn" data-v="*">×</button>
        <button class="btn digit" data-en="4" data-gu="૪" data-v="4">4</button><button class="btn digit" data-en="5" data-gu="૫" data-v="5">5</button><button class="btn digit" data-en="6" data-gu="૬" data-v="6">6</button><button class="btn" data-v="-">−</button>
        <button class="btn digit" data-en="1" data-gu="૧" data-v="1">1</button><button class="btn digit" data-en="2" data-gu="૨" data-v="2">2</button><button class="btn digit" data-en="3" data-gu="૩" data-v="3">3</button><button class="btn" data-v="+">+</button>
        <button class="btn digit" data-en="00" data-gu="૦૦" data-v="00">00</button><button class="btn digit" data-en="0" data-gu="૦" data-v="0">0</button><button class="btn" data-v=".">.</button><button class="btn eq" data-v="=">=</button>
    </div>
</div>

<div id="garage" class="overlay" onclick="if(event.target==this) openGarage()">
    <div class="modal" onclick="event.stopPropagation()">
        <h2 style="text-align:center; margin-bottom:15px; letter-spacing:2px;">V12 GARAGE</h2>
        <div class="row">VOLUME <input type="range" min="0" max="1" step="0.1" value="0.5" id="vol-ctrl" oninput="setCfg('vol', this.value)"></div>
        <div class="row">BEEP <select id="b-sel" onchange="setCfg('bProf', this.value)"></select></div>
        <div class="row">PIANO <select id="p-sel" onchange="setCfg('pProf', this.value)"></select></div>
        <div class="row">VOICE <button class="tog" onclick="tog('voice')" id="v-btn">ON</button></div>
        <div class="row">LANG <button class="tog" onclick="tog('guj')" id="l-btn">ENG</button></div>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
            <span style="font-weight:900; font-size:12px; color:#888;">LOGBOOK (MAX 10)</span>
            <button class="clr-btn" onclick="clearHist()">RESET</button>
        </div>
        <div id="hist"></div>
        <button class="exit-btn" onclick="openGarage()">EXIT GARAGE</button>
    </div>
</div>

<script>
    let fullEq = "", ans = "0", isRes = false, audio;
    let cfg = {
        bProf: localStorage.getItem('v12_bp') || "b1",
        pProf: localStorage.getItem('v12_pp') || "p1",
        vol: parseFloat(localStorage.getItem('v12_v')) || 0.5,
        guj: localStorage.getItem('v12_g') === 'true',
        voice: localStorage.getItem('v12_s') !== 'false',
        theme: parseInt(localStorage.getItem('v12_t')) || 0
    };

    const gujN = ['૦','૧','૨','૩','૪','૫','૬','૭','૮','૯'];
    const pFreqs = {'AC':261.6,'DEL':293.6,'%':329.6,'/':349.2,'7':392.0,'8':440.0,'9':493.8,'*':523.2,'4':587.3,'5':659.2,'6':698.4,'-':783.9,'1':880.0,'2':987.7,'3':1046.5,'+':1174.6,'0':1318.5,'.':1396.9,'=':1567.9,'00':1000};
    
    const beeps = [
        {n:"Mute", f:0}, {n:"Soft Tap",f:800,t:'sine',d:0.08,g:0.3}, {n:"Silk Touch",f:1200,t:'sine',d:0.04,g:0.2}, 
        {n:"Digital Click",f:2000,t:'square',d:0.02,g:0.1}, {n:"Low Pulse",f:150,t:'triangle',d:0.12,g:0.4}, 
        {n:"Bubble Pop",f:600,t:'sine',d:0.15,g:0.4}, {n:"Feather",f:1800,t:'sine',d:0.06,g:0.2}, 
        {n:"Glass Ting",f:2800,t:'sine',d:0.08,g:0.3}, {n:"Sport Beep",f:1100,t:'sawtooth',d:0.04,g:0.1}, {n:"Eco Click",f:450,t:'sine',d:0.06,g:0.3}
    ];

    const pianos = [
        {n:"Mute Piano", f:0}, {n:"Grand Piano",t:'triangle',d:1.5,g:0.7}, {n:"Studio One",t:'sine',d:0.6,g:0.9},
        {n:"Mellow Gold",t:'sine',d:1.2,g:0.5}, {n:"Honky Tonk",t:'sawtooth',d:0.7,g:0.2},
        {n:"Electric Sky",t:'square',d:1.0,g:0.1}, {n:"Classic 88",t:'triangle',d:1.4,g:0.4},
        {n:"Toy Box",t:'sine',d:0.3,g:0.8}, {n:"Bright Key",t:'sine',d:0.5,g:1.0},
        {n:"Dark Night",t:'triangle',d:2.5,g:0.3}, {n:"Dream State",t:'sine',d:3.0,g:0.2},
        {n:"Space Echo",t:'sine',d:2.8,g:0.4}, {n:"Jazz Club",t:'sawtooth',d:0.9,g:0.1}
    ];

    function playHorn() {
        if(!audio) return;
        const now = audio.currentTime;
        [150, 155].forEach(f => {
            let o = audio.createOscillator(), g = audio.createGain();
            o.type = 'sawtooth'; o.frequency.setValueAtTime(f, now);
            g.gain.setValueAtTime(0.4 * cfg.vol, now);
            g.gain.exponentialRampToValueAtTime(0.001, now + 0.6);
            o.connect(g); g.connect(audio.destination); o.start(); o.stop(now + 0.6);
        });
    }

    function ignite() {
        const doc = document.documentElement;
        if (doc.requestFullscreen) doc.requestFullscreen();
        else if (doc.webkitRequestFullscreen) doc.webkitRequestFullscreen();
        audio = new (window.AudioContext || window.webkitAudioContext)();
        playHorn();
        document.getElementById('startup').style.display = 'none';
        document.getElementById('container').style.opacity = '1';
    }

    function playSfx(v) {
        if(!audio || cfg.vol === 0) return;
        const now = audio.currentTime;
        const b = beeps[parseInt(cfg.bProf.slice(1))];
        const p = pianos[parseInt(cfg.pProf.slice(1))];
        if(b && b.f > 0) {
            let o = audio.createOscillator(), g = audio.createGain();
            o.type = b.t; o.frequency.value = b.f; g.gain.setValueAtTime(cfg.vol * b.g, now);
            g.gain.exponentialRampToValueAtTime(0.001, now + b.d);
            o.connect(g); g.connect(audio.destination); o.start(); o.stop(now + b.d);
        }
        if(p && pFreqs[v] && cfg.pProf !== "p0") {
            let o = audio.createOscillator(), g = audio.createGain();
            o.type = p.t; o.frequency.value = pFreqs[v];
            g.gain.setValueAtTime(cfg.vol * p.g, now); g.gain.exponentialRampToValueAtTime(0.001, now + p.d);
            o.connect(g); g.connect(audio.destination); o.start(); o.stop(now + p.d);
        }
    }

    function handle(v) {
        playSfx(v);
        const eqDisp = document.getElementById('eq-display');
        if(v === 'AC') { 
            fullEq = ""; ans = "0"; isRes = false; 
        }
        else if(v === 'DEL') { 
            if(isRes) { 
                fullEq = ""; ans = "0"; isRes = false; 
            } else {
                fullEq = fullEq.slice(0, -1);
                // UPDATE LIVE ANSWER ON DELETE
                try { ans = fullEq ? solve(fullEq) : "0"; } catch { ans = "0"; }
            }
        }
        else if(v === '=') {
            try {
                let result = solve(fullEq);
                let record = fullEq + "=" + result;
                log(record);
                fullEq = record; ans = result; isRes = true;
                if(cfg.voice) speak(result);
            } catch { ans = "ERR"; }
        } else {
            if(isRes) { 
                fullEq = (['+','-','*','/','%'].includes(v)) ? ans + v : v; isRes = false; 
            } else { 
                fullEq += v; 
            }
            try { ans = solve(fullEq); } catch {}
        }
        render();
        setTimeout(() => { eqDisp.scrollLeft = eqDisp.scrollWidth; }, 10);
    }

    function solve(s) {
        if(!s) return "0";
        let c = s.toString().replace(/×/g,'*').replace(/÷/g,'/');
        const pRegex = /([0-9.]+)([+\-*/])([0-9.]+)%/g;
        while(pRegex.test(c)) {
            c = c.replace(pRegex, (m, n1, op, n2) => {
                let pVal = (n1 * n2) / 100;
                if(op === '*' || op === '/') pVal = n2 / 100;
                return `(${n1}${op}${pVal})`;
            });
        }
        c = c.replace(/([0-9.]+)%/g, "($1/100)");
        if(['+','-','*','/'].includes(c.slice(-1))) c = c.slice(0,-1);
        try {
            let res = eval(c);
            return Number(res.toPrecision(12).split('e')[0]).toString().slice(0,12);
        } catch { return ans; }
    }

    function render() {
        const tr = (s) => cfg.guj ? s.toString().replace(/[0-9]/g, i => gujN[i]) : s;
        document.getElementById('eq-display').innerText = tr(fullEq || "0");
        document.getElementById('ans-display').innerText = tr(ans);
        document.querySelectorAll('.digit').forEach(b => {
            b.innerText = cfg.guj ? b.dataset.gu : b.dataset.en;
        });
    }

    function nextTheme() { cfg.theme = (cfg.theme + 1) % 50; localStorage.setItem('v12_t', cfg.theme); applyTheme(); }
    function applyTheme() { document.body.className = `t-${cfg.theme}`; }
    function openGarage() { const g = document.getElementById('garage'); if(g.style.display==='flex') { g.style.display='none'; } else { g.style.display='flex'; showLog(); playHorn(); } }
    function setCfg(k, v) { cfg[k] = v; localStorage.setItem('v12_'+(k==='bProf'?'bp':k==='pProf'?'pp':k==='vol'?'v':'t'), v); updateMenu(); }
    function tog(k) { cfg[k] = !cfg[k]; localStorage.setItem('v12_'+(k==='guj'?'g':'s'), cfg[k]); updateMenu(); }

    function updateMenu() {
        document.getElementById('b-sel').innerHTML = beeps.map((b,i)=>`<option value="b${i}">${b.n}</option>`).join('');
        document.getElementById('p-sel').innerHTML = pianos.map((p,i)=>`<option value="p${i}">${p.n}</option>`).join('');
        document.getElementById('b-sel').value = cfg.bProf;
        document.getElementById('p-sel').value = cfg.pProf;
        document.getElementById('vol-ctrl').value = cfg.vol;
        document.getElementById('v-btn').innerText = cfg.voice ? "ON" : "OFF";
        document.getElementById('l-btn').innerText = cfg.guj ? "GUJ" : "ENG";
        render();
    }

    function speak(t) { window.speechSynthesis.cancel(); const u = new SpeechSynthesisUtterance(t); u.lang = cfg.guj ? 'gu-IN' : 'en-IN'; window.speechSynthesis.speak(u); }
    function log(txt) { 
        const tr = (s) => cfg.guj ? s.toString().replace(/[0-9]/g, i => gujN[i]) : s;
        let h = JSON.parse(localStorage.getItem('v12h')||"[]"); 
        h.unshift(tr(txt)); if(h.length > 10) h = h.slice(0,10); 
        localStorage.setItem('v12h',JSON.stringify(h)); 
    }
    function showLog() { document.getElementById('hist').innerHTML = JSON.parse(localStorage.getItem('v12h')||"[]").map(x => `<div style="padding:10px; border-bottom:1px solid #eee; font-weight:bold; color:#222;">${x}</div>`).join(''); }
    function clearHist() { localStorage.removeItem('v12h'); showLog(); }

    document.getElementById('pad').addEventListener('touchstart', e => { if(e.target.dataset.v) { e.preventDefault(); handle(e.target.dataset.v); } });
    applyTheme(); updateMenu();
</script>
</body>
</html>
